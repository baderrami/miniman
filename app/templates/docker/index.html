{% extends "base.html" %}

{% block title %}Docker Management{% endblock %}

{% block content %}
<div class="container">
    <h1 class="mb-4">Docker Management</h1>

    <div class="card mb-4">
        <div class="card-header">
            <h5 class="card-title mb-0">Docker Status</h5>
        </div>
        <div class="card-body">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <a href="{{ url_for('docker.check_docker') }}" class="btn btn-primary">Check Docker Installation</a>
                </div>
                <div>
                    <form action="{{ url_for('docker.install_docker_route') }}" method="post">
                        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                        <button type="submit" class="btn btn-warning">Install Docker</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Dashboard Overview -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card text-center h-100">
                <div class="card-body">
                    <h5 class="card-title">Containers</h5>
                    <p class="card-text display-4">{{ container_count }}</p>
                    <a href="{{ url_for('docker.list_containers') }}" class="btn btn-primary">Manage</a>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center h-100">
                <div class="card-body">
                    <h5 class="card-title">Images</h5>
                    <p class="card-text display-4">{{ image_count }}</p>
                    <a href="{{ url_for('docker.list_images') }}" class="btn btn-primary">Manage</a>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center h-100">
                <div class="card-body">
                    <h5 class="card-title">Volumes</h5>
                    <p class="card-text display-4">{{ volume_count }}</p>
                    <a href="{{ url_for('docker.list_volumes') }}" class="btn btn-primary">Manage</a>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card text-center h-100">
                <div class="card-body">
                    <h5 class="card-title">Networks</h5>
                    <p class="card-text display-4">{{ network_count }}</p>
                    <a href="{{ url_for('docker.list_networks') }}" class="btn btn-primary">Manage</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation Tabs -->
    <ul class="nav nav-tabs mb-4" id="dockerTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="compose-tab" data-bs-toggle="tab" data-bs-target="#compose" type="button" role="tab" aria-controls="compose" aria-selected="true">Compose</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="containers-tab" data-bs-toggle="tab" data-bs-target="#containers" type="button" role="tab" aria-controls="containers" aria-selected="false">Containers</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="images-tab" data-bs-toggle="tab" data-bs-target="#images" type="button" role="tab" aria-controls="images" aria-selected="false">Images</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="volumes-tab" data-bs-toggle="tab" data-bs-target="#volumes" type="button" role="tab" aria-controls="volumes" aria-selected="false">Volumes</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="networks-tab" data-bs-toggle="tab" data-bs-target="#networks" type="button" role="tab" aria-controls="networks" aria-selected="false">Networks</button>
        </li>
    </ul>

    <!-- Tab Content -->
    <div class="tab-content" id="dockerTabsContent">
        <!-- Compose Tab -->
        <div class="tab-pane fade show active" id="compose" role="tabpanel" aria-labelledby="compose-tab">
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="card-title mb-0">Docker Compose Configurations</h5>
                    <a href="{{ url_for('docker.add_config') }}" class="btn btn-success">Add Configuration</a>
                </div>
                <div class="card-body">
                    {% if configs %}
                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>Name</th>
                                        <th>Description</th>
                                        <th>Status</th>
                                        <th>Last Updated</th>
                                        <th>Updates</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for config in configs %}
                                        <tr>
                                            <td>{{ config.name }}</td>
                                            <td>{{ config.description or 'No description' }}</td>
                                            <td>
                                                {% if config.is_active %}
                                                    <span class="badge bg-success">Active</span>
                                                {% else %}
                                                    <span class="badge bg-secondary">Inactive</span>
                                                {% endif %}
                                            </td>
                                            <td>{{ config.last_updated.strftime('%Y-%m-%d %H:%M') }}</td>
                                            <td>
                                                {% if config.update_available %}
                                                    <span class="badge bg-warning">Update Available</span>
                                                {% else %}
                                                    <span class="badge bg-info">Up to date</span>
                                                {% endif %}
                                            </td>
                                            <td>
                                                <a href="{{ url_for('docker.view_config', id=config.id) }}" class="btn btn-sm btn-primary">View</a>
                                            </td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                    {% else %}
                        <div class="alert alert-info">
                            No Docker Compose configurations found. <a href="{{ url_for('docker.add_config') }}">Add one</a> to get started.
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Containers Tab -->
        <div class="tab-pane fade" id="containers" role="tabpanel" aria-labelledby="containers-tab">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h5>Docker Containers</h5>
                <a href="{{ url_for('docker.list_containers') }}" class="btn btn-primary">View All Containers</a>
            </div>
            <p>Manage your Docker containers - start, stop, restart, remove, and execute commands in containers.</p>
            <div class="row">
                <div class="col-md-6">
                    <div class="card mb-3">
                        <div class="card-header">
                            <h6 class="card-title mb-0">Container Operations</h6>
                        </div>
                        <div class="card-body">
                            <ul>
                                <li>View container details and logs</li>
                                <li>Start, stop, and restart containers</li>
                                <li>Execute commands in containers</li>
                                <li>Remove containers</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card mb-3">
                        <div class="card-header">
                            <h6 class="card-title mb-0">Quick Actions</h6>
                        </div>
                        <div class="card-body">
                            <a href="{{ url_for('docker.list_containers') }}" class="btn btn-primary mb-2">List All Containers</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Images Tab -->
        <div class="tab-pane fade" id="images" role="tabpanel" aria-labelledby="images-tab">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h5>Docker Images</h5>
                <a href="{{ url_for('docker.list_images') }}" class="btn btn-primary">View All Images</a>
            </div>
            <p>Manage your Docker images - pull, build, and remove images.</p>
            <div class="row">
                <div class="col-md-6">
                    <div class="card mb-3">
                        <div class="card-header">
                            <h6 class="card-title mb-0">Image Operations</h6>
                        </div>
                        <div class="card-body">
                            <ul>
                                <li>View image details</li>
                                <li>Pull images from registries</li>
                                <li>Build images from Dockerfiles</li>
                                <li>Remove unused images</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card mb-3">
                        <div class="card-header">
                            <h6 class="card-title mb-0">Quick Actions</h6>
                        </div>
                        <div class="card-body">
                            <a href="{{ url_for('docker.list_images') }}" class="btn btn-primary mb-2">List All Images</a>
                            <a href="{{ url_for('docker.pull_image_route') }}" class="btn btn-success mb-2">Pull Image</a>
                            <a href="{{ url_for('docker.build_image_route') }}" class="btn btn-info mb-2">Build Image</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Volumes Tab -->
        <div class="tab-pane fade" id="volumes" role="tabpanel" aria-labelledby="volumes-tab">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h5>Docker Volumes</h5>
                <a href="{{ url_for('docker.list_volumes') }}" class="btn btn-primary">View All Volumes</a>
            </div>
            <p>Manage your Docker volumes - create and remove volumes for persistent data storage.</p>
            <div class="row">
                <div class="col-md-6">
                    <div class="card mb-3">
                        <div class="card-header">
                            <h6 class="card-title mb-0">Volume Operations</h6>
                        </div>
                        <div class="card-body">
                            <ul>
                                <li>View volume details</li>
                                <li>Create new volumes</li>
                                <li>Remove unused volumes</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card mb-3">
                        <div class="card-header">
                            <h6 class="card-title mb-0">Quick Actions</h6>
                        </div>
                        <div class="card-body">
                            <a href="{{ url_for('docker.list_volumes') }}" class="btn btn-primary mb-2">List All Volumes</a>
                            <a href="{{ url_for('docker.create_volume_route') }}" class="btn btn-success mb-2">Create Volume</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Networks Tab -->
        <div class="tab-pane fade" id="networks" role="tabpanel" aria-labelledby="networks-tab">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h5>Docker Networks</h5>
                <a href="{{ url_for('docker.list_networks') }}" class="btn btn-primary">View All Networks</a>
            </div>
            <p>Manage your Docker networks - create and remove networks, and connect containers to networks.</p>
            <div class="row">
                <div class="col-md-6">
                    <div class="card mb-3">
                        <div class="card-header">
                            <h6 class="card-title mb-0">Network Operations</h6>
                        </div>
                        <div class="card-body">
                            <ul>
                                <li>View network details</li>
                                <li>Create new networks</li>
                                <li>Connect containers to networks</li>
                                <li>Disconnect containers from networks</li>
                                <li>Remove unused networks</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card mb-3">
                        <div class="card-header">
                            <h6 class="card-title mb-0">Quick Actions</h6>
                        </div>
                        <div class="card-body">
                            <a href="{{ url_for('docker.list_networks') }}" class="btn btn-primary mb-2">List All Networks</a>
                            <a href="{{ url_for('docker.create_network_route') }}" class="btn btn-success mb-2">Create Network</a>
                            <a href="{{ url_for('docker.connect_container_to_network_route') }}" class="btn btn-info mb-2">Connect Container</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
